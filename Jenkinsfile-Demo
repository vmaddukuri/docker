void runStages(String tag) {
		
    
    docker.image(tag).inside("--privileged=true --user root") {
	
				
				stage('Copy the POM file'){

					sh '''
						dir=$(pwd)
						export PATH=$PATH:/opt/gradle/gradle-3.5/bin
						cd $dir && gradle init && chmod +x gradlew && ./gradlew sonarqube			
					'''						
				}

		}
	}
	
node{

	withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId: 'GIT-DEMO',
					  usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD']]) {
	
		sh '''git clone http://$USERNAME:$PASSWORD@github.com/vmaddukuri/docker.git'''
	
	}

	def customImage = docker.build("vijaymaddukuri/maven:latest1")
	

	imageTag = "vijaymaddukuri/maven:latest1"
	runStages(imageTag)
  
}
