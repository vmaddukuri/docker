void runStages(String tag) {
		
    
    docker.image(tag).inside("--privileged=true --user root") {
	
				
				stage('Copy the POM file'){

					sh '''
						dir=$(pwd)
						export PATH=$PATH:/opt/gradle/gradle-3.5/bin
						cd $dir && gradle init && chmod +x gradlew && ./gradlew sonarqube			
					'''						
				}

		}
	}
	
node{

	withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId: 'GIT-DEMO',
					  usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD']]) {
	
		sh '''git clone http://$USERNAME:$PASSWORD@github.com/vmaddukuri/docker.git'''
	
	}

	sh '''
	dir=$(pwd)
	docker build -f $dir/docker/Dockerfile . -t vijaymaddukuri:demo
	'''
	//def customImage = docker.build("vijaymaddukuri:demo")
	

	imageTag = "vijaymaddukuri/maven:latest1"
	runStages(imageTag)
  
}
